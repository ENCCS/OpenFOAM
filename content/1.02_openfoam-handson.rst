.. _openfoam-handson:


What is OenFOAM ?
-----------------

- OpenFOAM is an open source Computation Fluid Dynamics (CFD) solve released and developed primarily by OpenCFD Ltd since 2004. 

- It has a large user base across most areas of engineering and science, from both commercial and academic organizations. 

- OpenFOAM has an extensive range of features to solve anything from complex fluid flows involving chemical reactions, turbulence and heat transfer, to acoustics, solid mechanics and electromagnetics. 

- There are two main branches of OpenFOAM, 

  - one is from OpenFOAM Foundation (`www.openfoam.org <http://www.openfoam.org>`_),
  - and the other is OpenCFD Ltd (`www.openfoam.com <http://www.openfoam.com>`_).
  - In this guide, we only consider the later

-  Extensive guides, tutorials, code samples and documentation on the OpenFOAM
   can be found at `www.openfoam.com <http://www.openfoam.com>`_.

Installation
------------

Case studies
------------

Lid-driven cavity flow
^^^^^^^^^^^^^^^^^^^^^^

This case uses OpenFOAM to calculate the incompressible flow in a two-dimensional square domain.

- As OpenFOAM cases are not backward compatible, always copy cases from *$FOAM_TUTORIALS* of current version

.. code:: bash

 $ module add openfoam/1912  # Using OpenFOAM v1912         
 $ echo $FOAM_BASHRC
 /pdc/vol/openfoam/v1912/OpenFOAM-v1912/etc/bashrc
 $ source $FOAM_BASHRC
 $ cp -r $FOAM_TUTORIALS/incompressible/icoFoam/cavity/cavity . 

- The structure of the case is shown in the following

.. code:: bash

 $ cd cavity
 $ ls
 0 constant system

 $ tree 

 ├── 0 (time directory starting with T=0, initial conditions)
 │   ├── p (pressure)
 │   └── U (flow velocity)
 ├── Allrun (precanned run file)
 ├── constant (hard static stuff i.e. physical properties)
 │   ├── transportProperties (Transport Model e.g. Newtonian)
 └── system
    ├── blockMeshDict 
    ├── controlDict (the main dictionary for controlling the simulation)
    ├── fvSchemes
    ├── fvSolution
    ├── PDRblockMeshDict

- The default setting is to run the application *simpleFoam* in serial with two-dimensional block size of (20×20×1). The case will run to 0.5 with 0.005 per step. The middle results are stored in every 20 time steps. The workflow is following


Run the case
^^^^^^^^^^^^

.. code:: bash

 $ source $FOAM_BASHRC
 $ blockMesh # create the equivalent mesh of (20x20x1)
 $ icoFoam

Modification
^^^^^^^^^^^^

- For the scalability tests, the default mesh of 35 k cells is small, we need to increase the block mesh size. We can change the settings in file *system/blockMeshDict*, for example, from

i.e. the mesh size in x, y, and z directories increases 10 times.

- Also we can change the MPI rank and the decomposition method in file *system/decomposeParDict*, for example, change the default

The script *Allclean* can be used to delete the log files and remove the results from
motorBike run and then rerun again.

Validating the model
^^^^^^^^^^^^^^^^^^^^

